{
  "password_requirements": {
    "minimum_length": 12,
    "maximum_length": 128,
    "character_requirements": {
      "lowercase": "At least 1 lowercase letter (a-z)",
      "uppercase": "At least 1 uppercase letter (A-Z)",
      "digits": "At least 1 number (0-9)",
      "special_characters": "At least 1 special character (!@#$%^&*()_+-=[]{}|;:,.<>?)"
    },
    "forbidden_patterns": [
      "Common passwords (password123, admin, etc.)",
      "Sequential characters (123456, abcdef)",
      "Repeated characters (aaaaaa, 111111)",
      "Username or email variations",
      "Dictionary words without complexity"
    ],
    "validation_rules": {
      "no_whitespace_only": true,
      "no_leading_trailing_spaces": true,
      "unicode_support": true
    }
  },
  "hashing_specifications": {
    "primary_algorithm": "Argon2id",
    "argon2_parameters": {
      "memory_cost": "64MB (65536 KB)",
      "time_cost": "3 iterations",
      "parallelism": "4 threads",
      "hash_length": "32 bytes",
      "salt_length": "16 bytes"
    },
    "fallback_algorithm": "bcrypt",
    "bcrypt_parameters": {
      "cost_factor": 12,
      "salt_rounds": 12
    },
    "algorithm_selection_logic": "Use Argon2id by default, bcrypt for legacy compatibility if needed"
  },
  "salt_generation": {
    "method": "Cryptographically secure random number generator",
    "length": "16 bytes (128 bits)",
    "uniqueness": "Generate new salt for each password",
    "storage": "Store salt alongside hash in database",
    "encoding": "Base64 encoding for database storage"
  },
  "storage_security": {
    "database_design": {
      "separate_auth_table": true,
      "hash_column": "VARCHAR(255) to accommodate algorithm prefixes",
      "salt_column": "VARCHAR(255) for base64 encoded salt",
      "algorithm_column": "VARCHAR(50) to track hashing method used",
      "created_at": "TIMESTAMP for password age tracking"
    },
    "security_measures": {
      "database_encryption": "Encrypt database at rest",
      "connection_security": "Use TLS for all database connections",
      "access_control": "Restrict database access to auth service only",
      "audit_logging": "Log all password-related operations",
      "backup_security": "Encrypt database backups"
    },
    "hash_format": "$argon2id$v=19$m=65536,t=3,p=4$base64_salt$base64_hash",
    "migration_strategy": "Support multiple hash formats during algorithm transitions"
  },
  "implementation_guidelines": {
    "timing_attack_prevention": "Use constant-time comparison for hash verification",
    "rate_limiting": "Implement progressive delays for failed attempts",
    "password_history": "Store hash of last 5 passwords to prevent reuse",
    "expiration_policy": "Optional 90-day password expiration for high-security environments",
    "strength_meter": "Provide real-time password strength feedback during registration"
  }
}
